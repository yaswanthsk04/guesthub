{
  "title": "OpenWrt Client Monitoring",
  "panels": [
    {
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 0
      },
      "title": "Active Client Connections",
      "type": "table",
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "openwrt_client_active_connections",
          "instant": true,
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "auto",
            "displayMode": "color-background"
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "value": null, "color": "green" },
              { "value": 50, "color": "yellow" },
              { "value": 100, "color": "red" }
            ]
          }
        }
      }
    },
    {
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 0
      },
      "title": "Client Data Transfer",
      "type": "timeseries",
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(openwrt_client_bytes_total{direction=\"in\"}[5m])",
          "legendFormat": "{{ip}} IN",
          "refId": "A"
        },
        {
          "expr": "rate(openwrt_client_bytes_total{direction=\"out\"}[5m])",
          "legendFormat": "{{ip}} OUT",
          "refId": "B"
        }
      ],
      "options": {
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "fieldConfig": {
        "defaults": {
          "unit": "Bps",
          "custom": {
            "lineWidth": 1,
            "fillOpacity": 20
          }
        }
      }
    },
    {
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 8
      },
      "title": "Client Connection Details",
      "type": "table",
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "openwrt_client_connection_time_seconds",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "__name__": true,
              "job": true,
              "instance": true
            },
            "renameByName": {
              "ip": "Client IP",
              "state": "Connection State",
              "Value": "Connection Time (s)"
            }
          }
        }
      ]
    }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "time": {
    "from": "now-15m",
    "to": "now"
  }
}